<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Thể loại | DAOP Phim</title>
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>
  <script>
    window.DAOP = window.DAOP || {};
    (function(){
      var path = window.location.pathname;
      var m = path.match(/\/(?:quoc-gia|the-loai|nam-phat-hanh)(?:\/|$)/);
      if (m) { var idx = path.indexOf(m[0]); var before = path.slice(0, idx); window.DAOP.basePath = before || ''; }
    })();
  </script>
  <header class="site-header">
    <a href="../" class="site-logo">DAOP Phim</a>
    <nav class="site-nav"><a href="../phim-bo.html">Phim bộ</a><a href="../phim-le.html">Phim lẻ</a><a href="../tim-kiem.html">Tìm kiếm</a><a href="../the-loai/">Thể loại</a><a href="../quoc-gia/">Quốc gia</a><a href="../danh-sach/">Danh sách</a></nav>
  </header>
  <main class="container">
    <h1 id="page-title">Thể loại</h1>
    <div id="filter-bar" class="filter-bar"></div>
    <div id="movies-grid" class="movies-grid"></div>
    <div id="pagination" class="pagination"></div>
  </main>
  <footer class="site-footer"><p>Trường Sa, Hoàng Sa là của Việt Nam!</p></footer>
  <script src="../data/movies-light.js"></script>
  <script src="../data/filters.js"></script>
  <script src="../js/main.js"></script>
  <script src="../js/category-page.js"></script>
  <script>
    (function(){
      var path = window.location.pathname;
      var m = path.match(/\/the-loai\/([^/]+)(\.html)?$/);
      if (!m) m = path.match(/.+\/the-loai\/([^/]+)(\.html)?$/);
      var slug = m ? decodeURIComponent(m[1]) : null;
      if (!slug) {
        var fd = window.filtersData || {};
        var genreNames = fd.genreNames || {};
        var genreMap = fd.genreMap || {};
        var genres = Object.keys(genreNames).length ? Object.keys(genreNames).sort() : Object.keys(genreMap).sort();
        var name = function(s){ return genreNames[s] || s; };
        document.getElementById('page-title').textContent = 'Thể loại';
        document.getElementById('movies-grid').innerHTML = genres.length
          ? '<p>Chọn thể loại: ' + genres.map(function(g){ return '<a href="' + encodeURIComponent(g) + '.html">' + (name(g).replace(/</g, '&lt;')) + '</a>'; }).join(' · ') + '</p>'
          : '<p>Chưa có dữ liệu.</p>';
        document.getElementById('filter-bar').innerHTML = '';
        document.getElementById('pagination').innerHTML = '';
        return;
      }
      var fd = window.filtersData || {};
      var displayName = (fd.genreNames && fd.genreNames[slug]) || slug;
      document.getElementById('page-title').textContent = 'Thể loại: ' + displayName;
      new CategoryPage({
        baseFilter: function(){ return new Set((window.filtersData && window.filtersData.genreMap && window.filtersData.genreMap[slug]) || []); },
        title: 'Thể loại: ' + displayName,
        gridId: 'movies-grid',
        filterContainerId: 'filter-bar',
        paginationId: 'pagination'
      }).init();
    })();
  </script>
</body>
</html>
